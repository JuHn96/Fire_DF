<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>지능형 화재 감지 시스템 – 전체 UI 및 기능 설계 (최종 통합본)</title>
  <style>
    :root {
      --bg-page: #f5f5f5;
      --bg-card: #ffffff;
      --border-soft: #e5e7eb;
      --text-main: #111827;
      --text-muted: #4b5563;
      --accent: #ef4444;
      --accent-soft: #fef2f2;
      --code-bg: #111827;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
      background-color: var(--bg-page);
      color: var(--text-main);
      line-height: 1.6;
    }

    .page {
      max-width: 960px;
      margin: 32px auto;
      padding: 24px 20px 40px;
      background-color: var(--bg-card);
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
      border: 1px solid var(--border-soft);
    }

    h1, h2, h3, h4 {
      color: var(--text-main);
      margin-top: 24px;
      margin-bottom: 12px;
      line-height: 1.3;
    }

    h1 {
      font-size: 26px;
      margin-top: 0;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--border-soft);
    }

    h2 {
      font-size: 21px;
      border-left: 4px solid var(--accent);
      padding-left: 8px;
      margin-top: 32px;
    }

    h3 {
      font-size: 18px;
      margin-top: 18px;
    }

    h4 {
      font-size: 16px;
      margin-top: 14px;
    }

    p {
      margin: 6px 0 10px;
      color: var(--text-main);
    }

    .note {
      background-color: var(--accent-soft);
      border-left: 4px solid var(--accent);
      padding: 10px 12px;
      border-radius: 6px;
      font-size: 14px;
      margin: 10px 0 18px;
      color: var(--text-muted);
    }

    ul, ol {
      margin: 4px 0 12px 20px;
      padding-left: 16px;
    }

    li {
      margin: 2px 0;
    }

    hr {
      border: none;
      border-top: 1px solid var(--border-soft);
      margin: 24px 0;
    }

    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background-color: rgba(15, 23, 42, 0.04);
      padding: 2px 4px;
      border-radius: 4px;
      font-size: 13px;
    }

    pre {
      background-color: var(--code-bg);
      color: #e5e7eb;
      padding: 10px 12px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.5;
      margin: 8px 0 16px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 8px 0 16px;
      font-size: 14px;
    }

    th, td {
      border: 1px solid var(--border-soft);
      padding: 6px 8px;
      text-align: left;
      vertical-align: top;
    }

    th {
      background-color: #f9fafb;
      font-weight: 600;
    }

    tbody tr:nth-child(even) {
      background-color: #f9fafb;
    }

    .mono {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 13px;
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <div class="page">
    <h1>🔥 지능형 화재 감지 시스템 – 전체 UI 및 기능 설계 (최종 통합본)</h1>
    <p>
      본 문서는 지금까지 대화에서 정의된 <strong>전체 UI 구조 + 기능 + 화면별 역할 + CCTV 관리 탭까지 포함한 완전한 통합 사양서</strong>입니다.<br />
      (메인/서브/알림/로그·통계/CCTV관리/마이페이지 모든 내용 포함)
    </p>

    <hr />

    <h2>1. 전체 메뉴 구성</h2>
    <p>상단 공통 네비게이션 기준 화면 구성:</p>
    <ol>
      <li><strong>메인 대시보드</strong> – 메인 그룹 1~16 전체 표시</li>
      <li><strong>서브 대시보드</strong> – 선택된 그룹의 CCTV 16개 상세 표시</li>
      <li><strong>로그 &amp; 통계 탭(통합)</strong> – 이벤트 로그 + 통계 그래프</li>
      <li><strong>CCTV 관리 탭</strong> – CCTV 번호/이름/장비 ID/메인 지정</li>
      <li><strong>마이페이지</strong> – 템플릿 관리 + 카카오 연동</li>
    </ol>

    <hr />

    <h2>2. 알림 단계 정의 (UI 전반에서 공통 적용)</h2>

    <table>
      <thead>
        <tr>
          <th>단계</th>
          <th>의미</th>
          <th>UI 동작</th>
          <th>로그 저장</th>
          <th>카카오 발송</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>0단계</strong></td>
          <td>정상상태</td>
          <td>아무 표시 없음</td>
          <td>❌</td>
          <td>❌</td>
        </tr>
        <tr>
          <td><strong>1단계</strong></td>
          <td>경고</td>
          <td>모달 팝업 + 서브 CCTV 강조</td>
          <td>✔</td>
          <td>사용자가 템플릿 선택하여 <strong>수동 발송</strong></td>
        </tr>
        <tr>
          <td><strong>2단계</strong></td>
          <td>위험</td>
          <td>강한 모달 팝업 + CCTV 강조/확대</td>
          <td>✔</td>
          <td><strong>자동 발송</strong> (+수동 발송도 가능)</td>
        </tr>
      </tbody>
    </table>

    <div class="note">
      📌 <strong>0단계는 저장하지 않음 → 로그/통계 탭에서 보이지 않음</strong>
    </div>

    <hr />

    <h2>3. 메인 대시보드 UI (그룹 1~16 표시)</h2>

    <h3>3-1. 레이아웃</h3>
    <ul>
      <li>4×4 = <strong>16개 그룹 패널</strong></li>
      <li>각 패널 = "메인 그룹 1~16"</li>
      <li>CCTV 관리 탭에서 선택된 <strong>메인 CCTV 영상</strong>을 대표로 표시</li>
    </ul>

    <h3>3-2. 상태 표시 아이콘</h3>
    <ul>
      <li>1단계 이벤트 있음 → 노란 경고 아이콘</li>
      <li>2단계 이벤트 있음 → 빨간 위험 아이콘</li>
      <li>정상(0단계) → 아이콘 없음</li>
    </ul>

    <h3>3-3. 동작</h3>
    <ul>
      <li><strong>그룹 패널 더블클릭 → 해당 그룹의 서브 대시보드로 이동</strong></li>
      <li>예: 1번 패널 → 메인 1의 CCTV 1~16 표시 화면으로 이동</li>
    </ul>

    <hr />

    <h2>4. 서브 대시보드 (해당 그룹의 CCTV 16개)</h2>

    <h3>4-1. 상단 헤더 UI (한 줄 구조)</h3>
    <pre><code>&larr; 메인화면     [템플릿 ▼]   [발송]     🔔 알림 ON/OFF     🟢 연동상태     [경고 확인]</code></pre>

    <h3>각 요소 설명</h3>

    <h4>① ← 메인화면</h4>
    <p>메인 대시보드로 돌아감</p>

    <h4>② 템플릿 선택 ▼</h4>
    <ul>
      <li>마이페이지에서 등록한 템플릿 목록 표시</li>
      <li>선택만 가능, 수정은 불가</li>
      <li><strong>1단계 경고 상황에서 사용</strong></li>
    </ul>

    <h4>③ 발송 버튼</h4>
    <ul>
      <li>선택된 템플릿으로 <strong>수동 발송</strong></li>
      <li>BE에 <code>eventId + templateId + cctvId</code> 전달</li>
    </ul>

    <h4>④ 🔔 알림 ON/OFF</h4>
    <ul>
      <li>ON → 2단계 자동 발송 허용</li>
      <li>OFF → 자동 발송 차단</li>
    </ul>

    <h4>⑤ 🟢 연동 상태</h4>
    <ul>
      <li>카카오 연동 여부 표시만</li>
      <li>🟢 연동됨 / 🔴 미연동</li>
    </ul>

    <h4>⑥ 경고 확인 버튼</h4>
    <ul>
      <li>해당 이벤트를 <strong>0단계(정상)</strong> 으로 처리</li>
      <li>그룹/서브 대시보드의 경고 표시 제거</li>
    </ul>

    <hr />

    <h3>4-2. CCTV 4×4 화면 구성</h3>
    <ul>
      <li>16개 타일 = <code>그룹번호-1</code> ~ <code>그룹번호-16</code></li>
      <li>각 칸에:
        <ul>
          <li>실시간 영상 스트림</li>
          <li>하단에 <strong>CCTV 번호 + CCTV 이름</strong> 표시<br />
          → CCTV 이름 = CCTV 관리 탭에서 설정한 별칭</li>
        </ul>
      </li>
    </ul>

    <h4>기능 1) 더블클릭 확대</h4>
    <ul>
      <li>CCTV 더블클릭 → 크게 확대</li>
      <li>다시 더블클릭 or 닫기 → 원래대로</li>
    </ul>

    <h4>기능 2) 문제 CCTV 강조(깜빡임)</h4>
    <ul>
      <li>1/2단계 이벤트 발생 → 해당 CCTV 칸만 빨간 테두리 깜빡임</li>
      <li>경고 확인 시 해제</li>
    </ul>

    <hr />

    <h2>5. 모달 팝업 (1·2단계 공통)</h2>

    <h3>5-1. 포함 정보</h3>
    <ul>
      <li>단계 표시 (1단계/2단계)</li>
      <li>CCTV 이름</li>
      <li>발생 시간</li>
      <li>[해당 CCTV 보기] 버튼</li>
    </ul>

    <h3>5-2. 작동 방식</h3>

    <h4>1단계(경고)</h4>
    <ul>
      <li>모달 표시</li>
      <li>자동 발송 없음</li>
      <li>[해당 CCTV 보기] → 서브 대시보드 CCTV 강조</li>
      <li>템플릿 선택 후 수동 발송</li>
      <li>[경고 확인]으로 0단계 복귀</li>
    </ul>

    <h4>2단계(위험)</h4>
    <ul>
      <li>강한 모달 표시</li>
      <li>알림 ON + 연동됨이면 → <strong>자동 발송</strong>
        <ul>
          <li>템플릿의 <code>{cctv_name}</code> 자동 치환</li>
        </ul>
      </li>
      <li>서브 대시보드 CCTV 강조/확대</li>
      <li>[경고 확인]으로 0단계 복귀</li>
    </ul>

    <hr />

    <h2>6. 로그 &amp; 통계 탭 (한 화면 통합)</h2>

    <h3>6-1. 로그 리스트 영역</h3>
    <ul>
      <li>1단계 / 2단계 기록만 존재</li>
      <li>컬럼:
        <ul>
          <li>발생 시간</li>
          <li>단계(1/2)</li>
          <li>CCTV 이름</li>
          <li>그룹 번호</li>
          <li>처리 상태(미확인/확인 완료)</li>
          <li>발송 방식(수동/자동)</li>
        </ul>
      </li>
    </ul>

    <h3>6-2. 통계 그래프 영역</h3>
    <ul>
      <li>일/주/월별 이벤트 그래프</li>
      <li>1단계 vs 2단계 비율</li>
      <li>CCTV별/그룹별 이벤트 발생 수</li>
      <li>자동/수동 발송 비율</li>
    </ul>

    <hr />

    <h2>7. CCTV 관리 탭 (번호·이름·장비ID·메인)</h2>

    <h3>7-1. 구조</h3>
    <p>좌측</p>
    <pre><code>1
2
3
...
16</code></pre>
    <p>→ 메인 그룹 선택 메뉴</p>
    <p>우측 테이블<br />선택한 그룹의 16개 CCTV 설정 표시</p>

    <hr />

    <h3>7-2. 우측 테이블 구조 (최종 확정)</h3>

    <table>
      <thead>
        <tr>
          <th>CCTV번호</th>
          <th>CCTV이름(수정 가능)</th>
          <th>CCTV정보(장비 ID, 자동 표시)</th>
          <th>메인(대표 CCTV 체크)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td>로비 좌측</td>
          <td>CAM-01-ENTRANCE</td>
          <td>☐</td>
        </tr>
        <tr>
          <td>2</td>
          <td>로비 우측</td>
          <td>CAM-01-LOBBY-R</td>
          <td>☑</td>
        </tr>
        <tr>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
      </tbody>
    </table>

    <hr />

    <h3>7-3. 동작 방식</h3>

    <h4>CCTV번호</h4>
    <ul>
      <li>1~16</li>
      <li>수정 불가</li>
      <li>그룹 내 서브 CCTV 번호</li>
    </ul>

    <h4>CCTV이름</h4>
    <ul>
      <li>관제용 이름 (예: 로비 좌측, 창고 입구)</li>
      <li>수정 가능</li>
      <li>알림/서브 대시보드/로그에 그대로 반영됨</li>
    </ul>

    <h4>CCTV정보(장비 ID)</h4>
    <ul>
      <li>장비가 DB에 등록되면 BE가 자동으로 채워줌
        <ul>
          <li>예: <code>CAM-01-ENTRANCE</code></li>
        </ul>
      </li>
      <li>수정 불가</li>
    </ul>

    <h4>메인(체크박스)</h4>
    <ul>
      <li>그룹당 1개만 선택 가능</li>
      <li>저장 시 메인 대시보드 대표 CCTV로 사용됨</li>
    </ul>

    <hr />

    <h2>8. 마이페이지 탭 (템플릿 + 카카오 연동)</h2>

    <h3>템플릿 관리</h3>
    <ul>
      <li>추가/수정/삭제</li>
      <li><code>{cctv_name}</code>, <code>{time}</code> 등 변수 사용 가능</li>
      <li>"2단계 자동 발송용 템플릿" 지정 가능</li>
    </ul>

    <h3>카카오 플러스친구 연동</h3>
    <ul>
      <li>연동 여부 표시</li>
      <li>연동/재연동/해제 기능 포함</li>
      <li>연동 여부는 자동 발송 조건에 영향</li>
    </ul>

    <hr />

    <h2>9. 전체 알림 플로우 총정리</h2>

    <h3>✔ 1단계 경고</h3>
    <ol>
      <li>AI 이벤트 발생(level=1)</li>
      <li>모달 표시</li>
      <li>[해당 CCTV 보기] → 서브 대시보드 CCTV 강조</li>
      <li>템플릿 선택 후 [발송] → 카카오 수동 발송</li>
      <li>문제 해결 → [경고 확인] → 0단계 복귀</li>
    </ol>

    <h3>✔ 2단계 위험</h3>
    <ol>
      <li>AI 이벤트 발생(level=2)</li>
      <li>강한 경고 모달 표시</li>
      <li>알림 ON + 연동됨 → 자동 발송</li>
      <li>서브 CCTV 강조/확대</li>
      <li>처리 후 [경고 확인] → 정상 상태</li>
    </ol>

    <hr />

    <h2>10. 시스템 핵심 요약 (한 줄)</h2>
    <p class="note">
      <strong>메인 16그룹 → 서브 16CCTV → 모달 경고 → 템플릿 수동/자동 발송 → 경고 확인(0단계 복귀) → 로그·통계 기록 → CCTV 관리로 대표 화면/이름/장비 ID 관리</strong>
    </p>

    <p style="font-size: 13px; color: var(--text-muted); margin-top: 24px;">
      (본 문서는 FE·BE·UI 설계서 기반으로 그대로 사용 가능하도록 작성됨.)
    </p>
  </div>
</body>
</html>
